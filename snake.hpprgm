Rxz(θ)
BEGIN
RETURN [[COS(θ),0,SIN(θ)],[0,1,0],[−SIN(θ),0,COS(θ)]];
END;

Rxy(θ)
BEGIN
RETURN [[COS(θ),SIN(θ),0],[−SIN(θ),COS(θ),0],[0,0,1]];
END;

Ryz(θ)
BEGIN
RETURN [[1,0,0],[0,COS(θ),SIN(θ)],[0,−SIN(θ),COS(θ)]];
END;

EXPORT DD2080()
BEGIN
LOCAL x:=0,y:=0,s:=0;
LOCAL Ti,Tc;
LOCAL la:=0;
LOCAL l:=1.5,g:=0,g2:=0;
LOCAL f:=[0,0,l];
LOCAL Rot:=IDENMAT(3),eye;
LOCAL Tou,str,k:=−0.0003,h:=8;
LOCAL Si:=0;
DIMGROB_P(G1,320,240,0);
L1:=0.7*{[−1,−1,−1],[−1,−1,1],[−1,1,−1],[−1,1,1],[1,−1,−1],[1,−1,1],[1,1,−1],[1,1,1]};
L2:={{1,2,3},{2,3,4},{5,6,7},{6,7,8},{1,2,5},{2,5,6},{3,4,7},{4,7,8},{2,4,8},{2,8,6},{1,3,7},{1,7,5}};
FOR K FROM 1 TO 6 DO
L2(2*K,4):=RANDINT(0,#FFFFFFh);
L2(2*K-1,4):=L2(2*K,4);
END;
LOCAL LA:=L1,LB:=L2;
LA:={[−0.7,−0.7,−0.7],[−0.7,−0.7,0.7],[−0.7,0.7,−0.7],[−0.7,0.7,0.7],[0.7,−0.7,−0.7],[0.7,−0.7,0.7],[0.7,0.7,−0.7],[0.7,0.7,0.7],[−0.7,−0.7,0.8],[−0.7,−0.7,2.2],[−0.7,0.7,0.8],[−0.7,0.7,2.2],[0.7,−0.7,0.8],[0.7,−0.7,2.2],[0.7,0.7,0.8],[0.7,0.7,2.2],[−0.7,−0.7,2.3],[−0.7,−0.7,3.7],[−0.7,0.7,2.3],[−0.7,0.7,3.7],[0.7,−0.7,2.3],[0.7,−0.7,3.7],[0.7,0.7,2.3],[0.7,0.7,3.7],[−0.7,−0.7,3.8],[−0.7,−0.7,5.2],[−0.7,0.7,3.8],[−0.7,0.7,5.2],[0.7,−0.7,3.8],[0.7,−0.7,5.2],[0.7,0.7,3.8],[0.7,0.7,5.2],[−0.7,−0.7,5.3],[−0.7,−0.7,6.7],[−0.7,0.7,5.3],[−0.7,0.7,6.7],[0.7,−0.7,5.3],[0.7,−0.7,6.7],[0.7,0.7,5.3],[0.7,0.7,6.7],[−0.7,−0.7,6.8],[−0.7,−0.7,8.2],[−0.7,0.7,6.8],[−0.7,0.7,8.2],[0.7,−0.7,6.8],[0.7,−0.7,8.2],[0.7,0.7,6.8],[0.7,0.7,8.2],[−0.7,−0.7,8.3],[−0.7,−0.7,9.7],[−0.7,0.7,8.3],[−0.7,0.7,9.7],[0.7,−0.7,8.3],[0.7,−0.7,9.7],[0.7,0.7,8.3],[0.7,0.7,9.7],[0.8,−0.7,8.29999999999],[0.8,−0.7,9.69999999999],[0.8,0.7,8.29999999999],[0.8,0.7,9.69999999999],[2.2,−0.7,8.29999999999],[2.2,−0.7,9.69999999999],[2.2,0.7,8.29999999999],[2.2,0.7,9.69999999999],[2.3,−0.7,8.29999999998],[2.3,−0.7,9.69999999998],[2.3,0.7,8.29999999998],[2.3,0.7,9.69999999998],[3.7,−0.7,8.29999999998],[3.7,−0.7,9.69999999998],[3.7,0.7,8.29999999998],[3.7,0.7,9.69999999998],[3.8,−0.7,8.29999999997],[3.8,−0.7,9.69999999997],[3.8,0.7,8.29999999997],[3.8,0.7,9.69999999997],[5.2,−0.7,8.29999999997],[5.2,−0.7,9.69999999997],[5.2,0.7,8.29999999997],[5.2,0.7,9.69999999997],[5.3,−0.7,8.29999999996],[5.3,−0.7,9.69999999996],[5.3,0.7,8.29999999996],[5.3,0.7,9.69999999996],[6.7,−0.7,8.29999999996],[6.7,−0.7,9.69999999996],[6.7,0.7,8.29999999996],[6.7,0.7,9.69999999996],[5.29999999998,−0.7,6.79999999996],[5.29999999998,−0.7,8.19999999996],[5.29999999998,0.7,6.79999999996],[5.29999999998,0.7,8.19999999996],[6.69999999998,−0.7,6.79999999996],[6.69999999998,−0.7,8.19999999996],[6.69999999998,0.7,6.79999999996],[6.69999999998,0.7,8.19999999996],[5.29999999996,−0.7,5.29999999996],[5.29999999996,−0.7,6.69999999996],[5.29999999996,0.7,5.29999999996],[5.29999999996,0.7,6.69999999996],[6.69999999996,−0.7,5.29999999996],[6.69999999996,−0.7,6.69999999996],[6.69999999996,0.7,5.29999999996],[6.69999999996,0.7,6.69999999996],[5.29999999994,−0.7,3.79999999996],[5.29999999994,−0.7,5.19999999996],[5.29999999994,0.7,3.79999999996],[5.29999999994,0.7,5.19999999996],[6.69999999994,−0.7,3.79999999996],[6.69999999994,−0.7,5.19999999996],[6.69999999994,0.7,3.79999999996],[6.69999999994,0.7,5.19999999996],[5.29999999992,−0.7,2.29999999996],[5.29999999992,−0.7,3.69999999996],[5.29999999992,0.7,2.29999999996],[5.29999999992,0.7,3.69999999996],[6.69999999992,−0.7,2.29999999996],[6.69999999992,−0.7,3.69999999996],[6.69999999992,0.7,2.29999999996],[6.69999999992,0.7,3.69999999996],[5.2999999999,−0.7,0.79999999996],[5.2999999999,−0.7,2.19999999996],[5.2999999999,0.7,0.79999999996],[5.2999999999,0.7,2.19999999996],[6.6999999999,−0.7,0.79999999996],[6.6999999999,−0.7,2.19999999996],[6.6999999999,0.7,0.79999999996],[6.6999999999,0.7,2.19999999996],[5.29999999988,−0.7,−0.70000000004],[5.29999999988,−0.7,0.69999999996],[5.29999999988,0.7,−0.70000000004],[5.29999999988,0.7,0.69999999996],[6.69999999988,−0.7,−0.70000000004],[6.69999999988,−0.7,0.69999999996],[6.69999999988,0.7,−0.70000000004],[6.69999999988,0.7,0.69999999996],[5.29999999986,−0.7,−2.20000000004],[5.29999999986,−0.7,−0.80000000004],[5.29999999986,0.7,−2.20000000004],[5.29999999986,0.7,−0.80000000004],[6.69999999986,−0.7,−2.20000000004],[6.69999999986,−0.7,−0.80000000004],[6.69999999986,0.7,−2.20000000004],[6.69999999986,0.7,−0.80000000004],[5.29999999984,−0.7,−3.70000000004],[5.29999999984,−0.7,−2.30000000004],[5.29999999984,0.7,−3.70000000004],[5.29999999984,0.7,−2.30000000004],[6.69999999984,−0.7,−3.70000000004],[6.69999999984,−0.7,−2.30000000004],[6.69999999984,0.7,−3.70000000004],[6.69999999984,0.7,−2.30000000004],[5.29999999982,−0.7,−5.20000000004],[5.29999999982,−0.7,−3.80000000004],[5.29999999982,0.7,−5.20000000004],[5.29999999982,0.7,−3.80000000004],[6.69999999982,−0.7,−5.20000000004],[6.69999999982,−0.7,−3.80000000004],[6.69999999982,0.7,−5.20000000004],[6.69999999982,0.7,−3.80000000004],[5.2999999998,−0.7,−6.70000000004],[5.2999999998,−0.7,−5.30000000004],[5.2999999998,0.7,−6.70000000004],[5.2999999998,0.7,−5.30000000004],[6.6999999998,−0.7,−6.70000000004],[6.6999999998,−0.7,−5.30000000004],[6.6999999998,0.7,−6.70000000004],[6.6999999998,0.7,−5.30000000004],[5.29999999978,−0.7,−8.20000000004],[5.29999999978,−0.7,−6.80000000004],[5.29999999978,0.7,−8.20000000004],[5.29999999978,0.7,−6.80000000004],[6.69999999978,−0.7,−8.20000000004],[6.69999999978,−0.7,−6.80000000004],[6.69999999978,0.7,−8.20000000004],[6.69999999978,0.7,−6.80000000004]};
LB:={{1,2,3,16581734},{2,3,4,16581734},{5,6,7,1243985},{6,7,8,1243985},{1,2,5,5560986},{2,5,6,5560986},{3,4,7,9392313},{4,7,8,9392313},{2,4,8,2331906},{2,8,6,2331906},{1,3,7,5126958},{1,7,5,5126958},{9,10,11,16581734},{10,11,12,16581734},{13,14,15,1243985},{14,15,16,1243985},{9,10,13,5560986},{10,13,14,5560986},{11,12,15,9392313},{12,15,16,9392313},{10,12,16,2331906},{10,16,14,2331906},{9,11,15,5126958},{9,15,13,5126958},{17,18,19,16581734},{18,19,20,16581734},{21,22,23,1243985},{22,23,24,1243985},{17,18,21,5560986},{18,21,22,5560986},{19,20,23,9392313},{20,23,24,9392313},{18,20,24,2331906},{18,24,22,2331906},{17,19,23,5126958},{17,23,21,5126958},{25,26,27,16581734},{26,27,28,16581734},{29,30,31,1243985},{30,31,32,1243985},{25,26,29,5560986},{26,29,30,5560986},{27,28,31,9392313},{28,31,32,9392313},{26,28,32,2331906},{26,32,30,2331906},{25,27,31,5126958},{25,31,29,5126958},{33,34,35,16581734},{34,35,36,16581734},{37,38,39,1243985},{38,39,40,1243985},{33,34,37,5560986},{34,37,38,5560986},{35,36,39,9392313},{36,39,40,9392313},{34,36,40,2331906},{34,40,38,2331906},{33,35,39,5126958},{33,39,37,5126958},{41,42,43,16581734},{42,43,44,16581734},{45,46,47,1243985},{46,47,48,1243985},{41,42,45,5560986},{42,45,46,5560986},{43,44,47,9392313},{44,47,48,9392313},{42,44,48,2331906},{42,48,46,2331906},{41,43,47,5126958},{41,47,45,5126958},{49,50,51,16581734},{50,51,52,16581734},{53,54,55,1243985},{54,55,56,1243985},{49,50,53,5560986},{50,53,54,5560986},{51,52,55,9392313},{52,55,56,9392313},{50,52,56,2331906},{50,56,54,2331906},{49,51,55,5126958},{49,55,53,5126958},{57,58,59,16581734},{58,59,60,16581734},{61,62,63,1243985},{62,63,64,1243985},{57,58,61,5560986},{58,61,62,5560986},{59,60,63,9392313},{60,63,64,9392313},{58,60,64,2331906},{58,64,62,2331906},{57,59,63,5126958},{57,63,61,5126958},{65,66,67,16581734},{66,67,68,16581734},{69,70,71,1243985},{70,71,72,1243985},{65,66,69,5560986},{66,69,70,5560986},{67,68,71,9392313},{68,71,72,9392313},{66,68,72,2331906},{66,72,70,2331906},{65,67,71,5126958},{65,71,69,5126958},{73,74,75,16581734},{74,75,76,16581734},{77,78,79,1243985},{78,79,80,1243985},{73,74,77,5560986},{74,77,78,5560986},{75,76,79,9392313},{76,79,80,9392313},{74,76,80,2331906},{74,80,78,2331906},{73,75,79,5126958},{73,79,77,5126958},{81,82,83,16581734},{82,83,84,16581734},{85,86,87,1243985},{86,87,88,1243985},{81,82,85,5560986},{82,85,86,5560986},{83,84,87,9392313},{84,87,88,9392313},{82,84,88,2331906},{82,88,86,2331906},{81,83,87,5126958},{81,87,85,5126958},{89,90,91,16581734},{90,91,92,16581734},{93,94,95,1243985},{94,95,96,1243985},{89,90,93,5560986},{90,93,94,5560986},{91,92,95,9392313},{92,95,96,9392313},{90,92,96,2331906},{90,96,94,2331906},{89,91,95,5126958},{89,95,93,5126958},{97,98,99,16581734},{98,99,100,16581734},{101,102,103,1243985},{102,103,104,1243985},{97,98,101,5560986},{98,101,102,5560986},{99,100,103,9392313},{100,103,104,9392313},{98,100,104,2331906},{98,104,102,2331906},{97,99,103,5126958},{97,103,101,5126958},{105,106,107,16581734},{106,107,108,16581734},{109,110,111,1243985},{110,111,112,1243985},{105,106,109,5560986},{106,109,110,5560986},{107,108,111,9392313},{108,111,112,9392313},{106,108,112,2331906},{106,112,110,2331906},{105,107,111,5126958},{105,111,109,5126958},{113,114,115,16581734},{114,115,116,16581734},{117,118,119,1243985},{118,119,120,1243985},{113,114,117,5560986},{114,117,118,5560986},{115,116,119,9392313},{116,119,120,9392313},{114,116,120,2331906},{114,120,118,2331906},{113,115,119,5126958},{113,119,117,5126958},{121,122,123,16581734},{122,123,124,16581734},{125,126,127,1243985},{126,127,128,1243985},{121,122,125,5560986},{122,125,126,5560986},{123,124,127,9392313},{124,127,128,9392313},{122,124,128,2331906},{122,128,126,2331906},{121,123,127,5126958},{121,127,125,5126958},{129,130,131,16581734},{130,131,132,16581734},{133,134,135,1243985},{134,135,136,1243985},{129,130,133,5560986},{130,133,134,5560986},{131,132,135,9392313},{132,135,136,9392313},{130,132,136,2331906},{130,136,134,2331906},{129,131,135,5126958},{129,135,133,5126958},{137,138,139,16581734},{138,139,140,16581734},{141,142,143,1243985},{142,143,144,1243985},{137,138,141,5560986},{138,141,142,5560986},{139,140,143,9392313},{140,143,144,9392313},{138,140,144,2331906},{138,144,142,2331906},{137,139,143,5126958},{137,143,141,5126958},{145,146,147,16581734},{146,147,148,16581734},{149,150,151,1243985},{150,151,152,1243985},{145,146,149,5560986},{146,149,150,5560986},{147,148,151,9392313},{148,151,152,9392313},{146,148,152,2331906},{146,152,150,2331906},{145,147,151,5126958},{145,151,149,5126958},{153,154,155,16581734},{154,155,156,16581734},{157,158,159,1243985},{158,159,160,1243985},{153,154,157,5560986},{154,157,158,5560986},{155,156,159,9392313},{156,159,160,9392313},{154,156,160,2331906},{154,160,158,2331906},{153,155,159,5126958},{153,159,157,5126958},{161,162,163,16581734},{162,163,164,16581734},{165,166,167,1243985},{166,167,168,1243985},{161,162,165,5560986},{162,165,166,5560986},{163,164,167,9392313},{164,167,168,9392313},{162,164,168,2331906},{162,168,166,2331906},{161,163,167,5126958},{161,167,165,5126958},{169,170,171,16581734},{170,171,172,16581734},{173,174,175,1243985},{174,175,176,1243985},{169,170,173,5560986},{170,173,174,5560986},{171,172,175,9392313},{172,175,176,9392313},{170,172,176,2331906},{170,176,174,2331906},{169,171,175,5126958},{169,175,173,5126958}};
L5:={2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,1};
H:=9;
I:=1;
Tc:=TICKS;
WHILE  NOT ISKEYDOWN(4) DO
Tou:=MOUSE();
IF SIZE(Tou(1)) THEN
g:=g+k*(Tou(1,1)-Tou(1,3));
g2:=g2+k*(Tou(1,2)-Tou(1,4));
la:=1;
ELSE
la:=0;
END;

IF X==0 THEN
CASE
IF ISKEYDOWN(2) THEN
y:=y+π/2;
f:=[0,0,l]*Ryz(y);
X:=1;
END;

IF ISKEYDOWN(12) THEN
y:=y-π/2;
f:=[0,0,l]*Ryz(y);
X:=1;
END;


IF ISKEYDOWN(7) THEN
x:=x+π/2;
f:=[0,0,l]*Rxz(x);
y:=0;
X:=1;
END;
IF ISKEYDOWN(8) THEN
x:=x-π/2;
f:=[0,0,l]*Rxz(x);
y:=0;
X:=2;
END;
END;
END;




Ti:=TICKS-Tc;
s:=Si+f*Ti/500;
eye:=s+([0,0,−h]*Rxz(−g)-[0,2,0]);
IF Ti>500 THEN
Tc:=TICKS;
Si:=Si+f;
L:=SIZE(LA);
L1:=L1+f;
LA:=REPLACE(LA,(I-1)*8+1,L1);
H:=I;
I:=L5(I);

IF ISKEYDOWN()==0 THEN
X:=0;
END;


END;
IF la==0 THEN
g:=g+0.1*(−x-g);
END;


RECT_P(G1,#A0A0A0h);
str:=TRIANGLE_P(G1);
TRIANGLE_P(G1,(LA-eye)*(Rxz(g)),LB,{−1,"N",{−160,−120,255},{−1000,1000,−1000,1000,0.1,1000}},str);
BLIT_P(G1);
END;
END;
